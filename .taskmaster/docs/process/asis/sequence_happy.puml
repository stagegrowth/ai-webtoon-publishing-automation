@startuml asis_happy_path
!theme plain
title As-Is Happy Path (Step ID: ASIS-01 ~ ASIS-12)

actor "Customer" as Customer
participant "Web Admin UI" as UI
participant "Backend API" as API
database "DB" as DB
participant "Storage" as Storage
participant "Optional External" as Ext

== ASIS-00 Preconditions ==
note over Customer, Ext
  [사전 조건: 계정·접근권한·도구 준비]
end note

== ASIS-01 로그인/세션 ==
Customer -> UI : [로그인]
UI -> API : [인증 요청]
API -> DB : [쿼리/세션]
API --> UI : [토큰/세션]
UI --> Customer : [대시보드 표시]
note right of API
  **Input:** manual (ID/비밀번호)
  **Output:** session_id, user_id
  **Validation:** credential check
end note

== ASIS-02 워크스페이스·프로젝트 선택 ==
Customer -> UI : [워크스페이스/프로젝트 선택]
UI -> API : [목록 요청]
API -> DB : [쿼리]
API --> UI : [목록]
UI --> Customer : [표시]
note right of API
  **Input:** manual (선택)
  **Output:** workspace_id, project_id
  **Validation:** (없음)
end note

== ASIS-03 작품(Work) 생성/선택 ==
Customer -> UI : [작품 생성 또는 기존 선택]
UI -> API : [요청]
API -> DB : [저장/쿼리]
API --> UI : [work_id]
UI --> Customer : [표시]
note right of API
  **Input:** manual (작품명, 장르 등)
  **Output:** work_id, status
  **Validation:** 필수 필드
end note

== ASIS-04a 에피소드(Item) 메타 입력 ==
Customer -> UI : [에피소드 제목·요약 입력]
UI -> API : [저장 요청]
API -> DB : [저장]
API --> UI : [item_id]
UI --> Customer : [표시]
note right of API
  **Input:** manual (폼)
  **Output:** item_id, episode_no
  **Validation:** 필수 필드, 중복 에피소드 번호
end note

== ASIS-04b 에피소드 원고/파일 업로드 ==
Customer -> UI : [원고 파일 선택·업로드]
UI -> API : [파일 전송]
API -> Storage : [저장]
API -> DB : [경로/메타 저장]
API --> UI : [url/path]
UI --> Customer : [완료 표시]
note right of API
  **Input:** file (로컬 업로드)
  **Output:** asset path, version
  **Validation:** 확장자, 용량, 형식
end note

== ASIS-05 원고 검증(클라이언트/서버) ==
Customer -> UI : [검증 실행]
UI -> API : [검증 요청]
API -> API : [validate]
API --> UI : [result / errors]
UI --> Customer : [결과 표시]
note right of API
  **Input:** item_id, work_id
  **Output:** validation report, errors[]
  **Validation point:** 필수 필드, 분량, 금칙어
end note

== ASIS-06 콘티/구조화 (선택) ==
Customer -> UI : [콘티 생성 또는 수동 입력]
UI -> API : [요청]
API -> DB : [저장]
API --> UI : [응답]
UI --> Customer : [표시]
note right of API
  **Input:** manual / ai (선택)
  **Output:** conti_id, structure
  **Validation:** (선택 단계)
end note

== ASIS-07 에셋(이미지/메타) 생성·첨부 ==
Customer -> UI : [이미지 생성 또는 첨부]
UI -> API : [요청]
API -> Storage : [저장]
API -> DB : [메타 저장]
API --> UI : [asset_id, url]
UI --> Customer : [표시]
note right of API
  **Input:** file / ai output
  **Output:** asset_id, url, thumbnail
  **Validation:** 해상도, 용량
end note

== ASIS-08 최종 검토·수정 ==
Customer -> UI : [검토·수정]
UI -> API : [저장]
API -> DB : [업데이트]
API --> UI : [응답]
UI --> Customer : [표시]
note right of API
  **Input:** manual (수정 내용)
  **Output:** status, updated_at
  **Validation:** (편집 규칙)
end note

== ASIS-09 플랫폼 대상 선택·설정 ==
Customer -> UI : [플랫폼·채널 선택 및 설정]
UI -> API : [요청]
API -> DB : [저장]
API --> UI : [응답]
UI --> Customer : [표시]
note right of API
  **Input:** manual (플랫폼, 옵션)
  **Output:** target_platforms[], settings
  **Validation:** 지원 플랫폼 목록
end note

== ASIS-10 업로드/발행 요청 ==
Customer -> UI : [발행 실행]
UI -> API : [업로드 요청]
API -> Ext : [플랫폼 API 호출]
Ext --> API : [응답]
API -> DB : [상태 저장]
API --> UI : [report]
UI --> Customer : [진행/완료 표시]
note right of API
  **Input:** item_id, work_id, targets
  **Output:** job_id, status, report
  **Validation point:** 사전 검증 통과 여부
end note

== ASIS-11 발행 결과 확인 ==
Customer -> UI : [결과 조회]
UI -> API : [상태 요청]
API -> DB : [쿼리]
API --> UI : [status, url]
UI --> Customer : [표시]
note right of API
  **Input:** job_id / item_id
  **Output:** status, platform_url, errors
  **Validation:** (없음)
end note

== ASIS-12 Post-Check/완료 ==
note over Customer, Ext
  [완료 후 검증: 링크 확인, 플랫폼 노출 확인]
end note

@enduml
